## ■資格取得に向けて勉強したことのメモ
## ■公式サイトと試験ガイドを眺める
* 公式サイト
<https://aws.amazon.com/jp/certification/certified-devops-engineer-professional/>
* 試験ガイド
https://d1.awsstatic.com/training-and-certification/docs-devops-pro/AWS%20Certified%20DevOps%20Engineer%20-%20Professional%20Exam%20Guide_v1.5_FINAL%20JPN.pdf
- - - 

## ■試験分野と比重を頭に入れておく
| 分野 | 比重 |
|:----|------------:|
|分野 1: SDLC の自動化 |22%|
|分野 2: 構成管理および Infrastructure as Code| 19%|
|分野 3: 監視およびロギング| 15%|
|分野 4: ポリシーと標準の自動化| 10%|
|分野 5: インシデントおよびイベントへの対応| 18%|
|分野 6: 高可用性、フォールトトレランス、およびディザスタリカバリ| 16%|
|合計 |100%|
- - - 

### ■分野１のSDLCの自動化

* 分野 1: SDLC の自動化
  * 1.1. CI/CD パイプラインを自動化するために必要な概念を適用する。
  * 1.2. ソース管理戦略の内容、およびソース管理戦略を実装する方法を決める。
  * 1.3. テストを自動化および統合するために必要な概念を適用する。
  * 1.4. アーティファクトをセキュアに作成および管理するために必要な概念を適用する。
  * 1.5. 展開/配信戦略の内容 (例: A/B、ブルー/グリーン、カナリ-、レッド/ブラック)、および、AWS サービスを使用して展開/配信戦略を実装する方法を決める。

そもそもSDLCってなんやねん？ｗ  
なんの略？的な。。。  

>ソフトウェア開発ライフサイクル（SDLC）とは、高品質、低コストのソフトウェアを可能な限り最短の生産期間で製造するためのプロセスです。 SDLCには計画、設計、実装、テスト、デプロイなどの複数のフェーズがあります。

### ■分野１サンプル問題

1）会社はAWS CodeCommitで製品のソースコードを管理します。同社はAWS CodePipelineを使用して製品のCI / CDパイプラインを作成しています。
パイプラインは、CodeCommitリポジトリのマスターブランチへの変更時に自動的に開始する必要があります。
アプリケーションは毎日変更されるため、パイプラインは可能な限り応答する必要があります。
これらの要件を満たすために、DevOpsエンジニアはどのような行動を取る必要がありますか？

  *A.リポジトリを定期的にチェックするようにパイプラインを構成します。変更が検出されたときにパイプラインを開始します。  
  *B.変更時にAmazon CloudWatchイベントイベントを生成し、イベントに応じて開始するようにパイプラインを構成します。  
  *C. AWS Lambda関数を定期的に実行するようにリポジトリを構成します。関数は、リポジトリを確認し、変更が検出されたときにパイプラインを開始する必要があります。  
  *D.変更時にSNS通知を公開するようにリポジトリを構成します。パイプラインをAmazon SNSトピックにサブスクライブします。  

【解説】
この問題は、CodePipeline におけるCodeCommit との連携方法に関する問題です。問題文のポイントは、CodeCommit にコミットされたら”可能な限り迅速に” 対応するという部分です。
選択肢としてAとC は”定期的に” チェックしますが、B はイベントに応答してパイプラインが開始しますので選択肢としてはAやCよりはBの方が適しています。
なお、D はCodePipeline の仕組みには当てはまりません。よって正解はB となります。
なお、マネジメントコンソール上でCodepipeline を作成すると、B の選択肢のCloudWatch Events は自動的に構成されますので気が付かない場合があります。CLI やAPI で作成するとCloudWatch Events を自分で構成する必要がありますので知識として定着します。Professional な認定では、マネジメントコンソールだけを触っていると知識として足りない部分が出てきますので、CLI などで各サービスを操作してみることも重要です。ただし、すべての細かい知識を覚えておくのはなかなか難しいですので、迷った場合は、消去法で選択肢を除外するといったテクニックも有効です。
パイプラインの実行に関しては以下のドキュメントに記載があります。
https://docs.aws.amazon.com/ja_jp/codepipeline/latest/userguide/pipelines-about-starting.html

### ■分野１サンプル問題
2）開発チームがAWS CodeCommitリポジトリを設定したいと考えています。
開発者は自分のブランチに変更をプッシュできますが、マスターブランチにコミットをプッシュしたりプルリクエストをマージしたりすることはできてはいけません。さらに、コミットまたはマージがマスターブランチで発生するたびに、プロジェクトマネージャは通知を受け取る必要があります。
どのステップの組み合わせがマスターブランチを保護し、アラートを最短の遅延で送信しますか？
 （2つ選択）
 
  *A.マスターブランチにコミットをプッシュし、プルリクエストをマージし、ファイルを追加するアクションを拒否するAWS IAMポリシーを開発者IAMグループに添付します。  
  *B.IAM開発者グループのメンバーにコミットのプッシュ、プルリクエストのマージ、およびマスターブランチへのファイルの追加のアクションを拒否するリソースポリシーをCodeCommitリポジトリに添付します。  
  *C.15分ごとに実行されるAWS Lambda関数を設定して、リポジトリの変更を確認し、Amazon SNSトピックに通知を発行します。  
  *D.マスターブランチのCodeCommitリポジトリの状態変更イベントによってトリガーされるAmazon CloudWatch Events ルールを設定し、ターゲットとしてAmazon SNSトピックを追加します。  
  *E.ログイベントをAmazon CloudWatch Logsに送信するようにAWS CloudTrailを設定します。リポジトリイベントを識別するためのメトリックフィルタを定義します。 Amazon SNSトピックをターゲットとしてCloudWatchアラームを作成します。  

【解説】
 A はIAMポリシーによるアクセスコントロールで、B はリソースベースのアクセスコントロールです。CodeCommit ではリソースベースのポリシー(S3 のバケットポリシーのような仕組み) はサポートしていないため、A のIAM ポリシーを用いたアクセスコントロールが正解となります。
CloudWatch Events により、CodeCommit リポジトリのブランチレベルの状態変化を拾うことができます。
https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/EventTypes.html#codecommit_event_type
CloudWatch Events は変更が発生した場合に即座に対応しますので、”最短の遅延” という条件に最も即した選択肢はD となります。

### ■分野１サンプル問題
3）ある企業が、アプリケーションを構築するためにAWS CodeBuildを使用しています。
会社の方針では、すべてのビルド**アーティファクトは暗号化して保存**することを要求しています。
アーティファクトへのアクセスは、**操作用のロールを引き受ける権限を持つIAMユーザーに限定**される必要があります。
これらの要件をどのように満たすことができますか？

  *A.ビルドオブジェクトをAmazon S3バケットにプッシュするポストビルドコマンドをCodeBuildビルド仕様に追加します。リクエストにヘッダーx-amz-server-side-encryptionが含まれていない限り、バケットへのアップロードを禁止するバケットポリシーを設定します。操作用のIAMグループを参照するNotPrincipalセクションを持つすべてのアクションに対してDenyステートメントを追加します。  
  *B. ビルドオブジェクトをAmazon S3バケットにプッシュするポストビルドコマンドをCodeBuildビルド仕様に追加します。 AWS Lambda関数をトリガーしてオブジェクトを取得し、それを暗号化してから、暗号化されたタグキーと正しいグ値を使用してS3バケットに戻すようにS3イベント通知を設定します。 NotPrincipalセクションが操作用のIAMグループを参照し、ConditionセクションがEncryptedタグを参照するすべてのアクションに対して、Denyステートメントを使用してS3バケットポリシーを追加します。  
  *C. ビルドオブジェクトをS3デフォルト暗号化が有効になっているAmazon S3バケットにプッシュするポストビルドコマンドをCodeBuildビルド仕様に追加します。操作用のIAMロールを参照するNotPrincipalセクションを持つすべてのアクションに対して、Denyステートメントを含むS3バケットポリシーを設定します。  
  *D. 指定されたカスタマーマスターキー（CMK）で暗号化するためにAWS KMS Encrypt APIを呼び出すCodeBuildビルド仕様にポストビルドコマンドを追加します。暗号化されたアーティファクトをAmazon S3バケットにプッシュしてから、AWS KMSでそのCMKの唯一のキーユーザーとしてIAMオペレーショングループを設定します。  

【解説】
A/B/Dは、IAM グループで限定するという記述となっています。これは問題文のIAM ロールに限定するというポイントと異なっていますので除外できます。
この問題のポイントは、アーティファクトを暗号化すること、IAM ロールによるアクセスのみを許可することという二点です。

### ■分野１サンプル問題
4）あるDevOpsのエンジニアは、AWS上のアプリケーションにBlue/Green デプロイメントプロセスを実装し、環境間でトラフィックを徐々にシフトできるようにしたいと考えています。アプリケーションは、ELB Application Load Balancerの背後にあるAmazon EC2インスタンス上で実行されます。インスタンスはEC2 Auto Scalingグループで実行されます。データはAmazon RDS Multi-AZ DBインスタンスに保存されます。外部向けDNSはAmazon Route 53によって提供されます。
Blue/Green プロセスを実行するのはどのステップの組み合わせですか。
（３つ選択）

  *A. 同じApplication Load Balancerの背後に2つ目のAuto Scalingグループを作成します。  
  *B. 2つ目のApplication Load BalancerとAuto Scalingグループを作成します。  
  *C. Route 53で新しい環境を指す2番目のエイリアスレコードを作成し、2つのレコード間でフェールオーバールーティングポリシーを使用します。  
  *D. Route 53で新しい環境を指す2番目のエイリアスレコードを作成し、2つのレコード間で加重ルーティングポリシーを使用します。  
  *E. 同じRDSデータベースインスタンスを使用するように新しいEC2インスタンスを設定します。  
  *F. RDSデータベースインスタンスのフェイルオーバーノードを使用するように新しいEC2インスタンスを構成します。  

【解説】
B,D,E
